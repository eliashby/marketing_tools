{"remainingRequest":"/home/eashby/Dev/Marketing/marketing-library/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/eashby/Dev/Marketing/marketing-library/src/applications/thankyou/ticket-download/App.vue?vue&type=style&index=0&id=44ab2c64&scoped=true&lang=css&","dependencies":[{"path":"/home/eashby/Dev/Marketing/marketing-library/src/applications/thankyou/ticket-download/App.vue","mtime":1567793438454},{"path":"/home/eashby/Dev/Marketing/marketing-library/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/eashby/Dev/Marketing/marketing-library/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/eashby/Dev/Marketing/marketing-library/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/eashby/Dev/Marketing/marketing-library/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#image-bases {\n  display: none;\n}\n.ticket-download {\n  border: 1px solid #707070;\n  margin: 5px;\n  margin-bottom: 25px;\n  padding: 15px 0;\n  text-align: left;\n}\n\n.ticket-download p {\n  margin-bottom: 5px;\n  padding: 0;\n}\n\n.qr-wrapper {\n  align-items: center;\n  display: flex;\n}\n\n.qr-border {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 80%;\n  border: none;\n  margin: 0 auto;\n  height: 90%;\n}\n\n.qr-image {\n  height: 200px;\n  width: 200px;\n}\n\n.ticket-group {\n  margin-top: 20px;\n}\n\n.label {\n  text-transform: uppercase;\n  font-size: 12px;\n  font-weight: 600;\n  color: #7c7c7c;\n}\n\n.text {\n  text-transform: capitalize;\n  font-size: 18px;\n}\n\n.link {\n  color: #f5245b;\n  display: inline-block;\n}\n\n.download-wrapper {\n  position: relative;\n  display: block;\n  margin: 0 auto;\n  width: 125px;\n}\n\n.download-wrapper p {\n  position: absolute;\n  width: 100%;\n}\n\n.download-wrapper img {\n  width: 100%;\n}\n\n@media screen and (min-width: 768px) {\n  .qr-border {\n    border-right: 1px solid;\n  }\n}\n",{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src/applications/thankyou/ticket-download","sourcesContent":["<template>\n  <div>\n    <div id=\"image-bases\">\n      <img id=\"ticket_base\" ref=\"ticketBase\" :src=\"ticketUrl\" alt=\"ticket\">\n      <canvas ref=\"canvas\" id=\"ticket-canvas\" width=\"500\" height=\"890\"></canvas>\n    </div>\n    <b-row class=\"ticket-download\">\n      <b-col cols=\"12\" md=\"4\" class=\"qr-wrapper text-center\">\n        <div class=\"qr-border\">\n          <img class=\"qr-image\" ref=\"qrCode\" :src=\"qrSrc\" alt=\"qr-code\">\n        </div>\n      </b-col>\n      <b-col cols=\"12\" md=\"8\">\n        <div>\n          <h5>{{ registration.selected_event.draw }}</h5>\n          <b-row>\n            <b-col cols=\"12\" md=\"6\" class=\"ticket-group\">\n              <p class=\"label\">name</p>\n              <p class=\"text\">{{ registration.first_name }} {{ registration.last_name }}</p>\n            </b-col>\n            <b-col cols=\"12\" md=\"6\" class=\"ticket-group\">\n              <p class=\"label\">ticket type</p>\n              <p class=\"text\">E-Ticket</p>\n            </b-col>\n          </b-row>\n        </div>\n        <b-row>\n          <b-col cols=\"12\" md=\"6\" class=\"ticket-group\">\n            <p class=\"label\">date</p>\n            <p class=\"text\">{{ eventDate }}</p>\n            <p class=\"text\">{{ registration.selected_event.converted_time }}</p>\n            <a class=\"link\" target=\"_blank\" :href=\"calendarSrc\">Add to Calendar</a>\n          </b-col>\n          <b-col cols=\"12\" md=\"6\" class=\"ticket-group\">\n            <p class=\"label\">venue</p>\n            <p class=\"text\">{{ registration.selected_event.venue_name }}</p>\n            <a class=\"link\" target=\"_blank\" :href=\"mapSrc\">View Map</a>\n          </b-col>\n        </b-row>\n      </b-col>\n    </b-row>\n    <!--\n    <div class=\"download-wrapper\">\n      <a\n        class=\"text-center\"\n        href=\"#\"\n        id=\"ticket_download\"\n        ref=\"qrDownload\"\n        target=\"_self\"\n        download=\"tickets.png\"\n      >\n        <p class=\"link\">download ticket</p>\n        <img\n          src=\"https://s3-us-west-2.amazonaws.com/response-web/images/Dev_Marketing_Library/ticket_download_thumb.jpg\"\n          alt=\"download ticket icon\"\n        >\n      </a>\n    </div>\n    -->\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport snippets from \"../../../lib/helpers/snippets\";\nimport moment from \"moment\";\nimport { mapActions, mapState } from \"vuex\";\nimport QRCode from \"qrcode\";\nimport bugsnagClient from \"../../../lib/bugsnag.js\";\n\nexport default {\n  data() {\n    return {\n      ticketUrl: \"\",\n      qrSrc: \"\",\n      calendarSrc: \"\",\n      mapSrc: \"\"\n    };\n  },\n  computed: {\n    ...mapState({ registration: state => state.registration }),\n    eventDate() {\n      return moment(this.registration.selected_event.start_date).format(\"dddd, MMM. DD\");\n    }\n  },\n  watch: {\n    registration() {\n      QRCode.toDataURL(this.registration.qr_url)\n        .then(url => {\n          this.qrSrc = url;\n          this.getImage();\n        })\n        .catch(err => bugsnagClient.notify(new Error('Failed at QRCode.toDataURL() function')));\n      this.mapSrc = this.registration.selected_event.map_link;\n      this.calendarSrc = `https://api.getstiki.com/v1/ical/response/lp?event=${this.registration.selected_event.id}`;\n    }\n  },\n  methods: {\n    getImage() {\n      axios\n        .get(\"https://sc-search.responsewebops.com/api/ticket_wireframe\")\n        .then(res => {\n          this.ticketUrl = res.data;\n          this.generateTicket();\n        })\n        .catch(error => bugsnagClient.notify(new Error('Failed at getImage() api call')));\n    },\n    generateTicket(data) {\n      const ticketBase = this.$refs.ticketBase;\n      // const qrDownload = this.$refs.qrDownload;\n      const qrCode = this.$refs.qrCode;\n\n      const event_data = this.registration.selected_event;\n      const ticketHeader = event_data.draw;\n      const ticketType = \"E-Ticket\";\n      const ticketDate = `Time: ${moment(event_data.start_date).format(\"dddd, MMMM DD, YYYY @ h:mma\")}`;\n      const ticketReservation = `${this.registration.first_name} ${this.registration.last_name}`;\n      const ticketVenue = event_data.venue_name;\n      const ticketVenueAddress = event_data.street_address1;\n      const ticketVenueState = `${event_data.city}, ${event_data.state} ${event_data.zip}`;\n\n      setTimeout(() => {\n        const canvas = this.$refs.canvas;\n        const ctx = canvas.getContext(\"2d\");\n\n        ctx.drawImage(ticketBase, 0, 0, 500, 890);\n        ctx.drawImage(qrCode, 100, 650, 300, 200);\n\n        // Ticket Header\n        ctx.font = \"36px Arial\";\n        ctx.fillStyle = \"#000\";\n        ctx.fillText(ticketHeader, 55, 150);\n\n        // Ticket Date\n        ctx.font = \"18px Arial\";\n        ctx.fillStyle = \"#000\";\n        ctx.fillText(ticketDate, 55, 180);\n\n        // TIcket Type\n        ctx.font = \"18px Arial\";\n        ctx.fillStyle = \"#000\";\n        ctx.fillText(ticketType, 55, 250);\n\n        // Ticket Reservation\n        ctx.font = \"18px Arial\";\n        ctx.fillStyle = \"#000\";\n        ctx.fillText(ticketReservation, 55, 320);\n\n        ctx.font = \"18px Arial\";\n        ctx.fillStyle = \"#000\";\n        ctx.fillText(ticketVenue, 55, 385);\n\n        ctx.font = \"18px Arial\";\n        ctx.fillStyle = \"#000\";\n        ctx.fillText(ticketVenueAddress, 55, 425);\n\n        ctx.font = \"18px Arial\";\n        ctx.fillStyle = \"#000\";\n        ctx.fillText(ticketVenueState, 55, 445);\n        /*\n        const imgLink = qrDownload;\n\n        canvas.toBlob(function(blob) {\n          imgLink.href = URL.createObjectURL(blob);\n        }, \"image/png\");\n        */\n      }, 1000);\n    }\n  }\n};\n</script>\n\n\n<style scoped>\n#image-bases {\n  display: none;\n}\n.ticket-download {\n  border: 1px solid #707070;\n  margin: 5px;\n  margin-bottom: 25px;\n  padding: 15px 0;\n  text-align: left;\n}\n\n.ticket-download p {\n  margin-bottom: 5px;\n  padding: 0;\n}\n\n.qr-wrapper {\n  align-items: center;\n  display: flex;\n}\n\n.qr-border {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 80%;\n  border: none;\n  margin: 0 auto;\n  height: 90%;\n}\n\n.qr-image {\n  height: 200px;\n  width: 200px;\n}\n\n.ticket-group {\n  margin-top: 20px;\n}\n\n.label {\n  text-transform: uppercase;\n  font-size: 12px;\n  font-weight: 600;\n  color: #7c7c7c;\n}\n\n.text {\n  text-transform: capitalize;\n  font-size: 18px;\n}\n\n.link {\n  color: #f5245b;\n  display: inline-block;\n}\n\n.download-wrapper {\n  position: relative;\n  display: block;\n  margin: 0 auto;\n  width: 125px;\n}\n\n.download-wrapper p {\n  position: absolute;\n  width: 100%;\n}\n\n.download-wrapper img {\n  width: 100%;\n}\n\n@media screen and (min-width: 768px) {\n  .qr-border {\n    border-right: 1px solid;\n  }\n}\n</style>\n"]}]}